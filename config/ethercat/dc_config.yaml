# EtherCAT Distributed Clock (DC) Configuration
# DC 동기화를 통해 모든 슬레이브를 ±1μs 이내로 정밀 동기화

master:
  index: 0
  cycle_time_ns: 1000000  # 1ms = 1,000,000 ns (RT cycle time)
  priority: 99
  cpu_affinity: 1

# DC 동기화 설정
dc_config:
  enable: true                    # DC 동기화 활성화
  reference_slave: 0              # 기준 slave (보통 첫 번째 장치)
  sync0_cycle_time: 1000000       # SYNC0 주기 (nanoseconds) - RT cycle과 동일하게 설정
  sync0_shift_time: 0             # SYNC0 shift (nanoseconds) - 위상 조정
  sync1_cycle_time: 0             # SYNC1 주기 (0 = 비활성화)

# Slave 설정 예시 (DC 지원 장치)
slaves:
  - alias: 0
    position: 0
    vendor_id: "0x00000002"       # Beckhoff
    product_code: "0x044c2c52"    # EK1100 EtherCAT Coupler
    device_name: "EK1100_Coupler"
    device_type: "IO_MODULE"
    pdo_mappings: []

  - alias: 0
    position: 1
    vendor_id: "0x00000002"       # Beckhoff
    product_code: "0x13ed3052"    # EL5101 Incremental Encoder (DC 지원)
    device_name: "Encoder_Axis1"
    device_type: "SENSOR"
    pdo_mappings:
      - direction: "INPUT"
        index: 0x1A00
        subindex: 0x01
        bit_length: 32
        data_type: "INT32"
        description: "Position Value"

  - alias: 0
    position: 2
    vendor_id: "0x00000002"       # Beckhoff
    product_code: "0x1b583052"    # EL7041 Stepper Motor (DC 지원)
    device_name: "Motor_Axis1"
    device_type: "MOTOR"
    pdo_mappings:
      - direction: "OUTPUT"
        index: 0x1602
        subindex: 0x01
        bit_length: 16
        data_type: "UINT16"
        description: "Control Word"
      - direction: "OUTPUT"
        index: 0x1602
        subindex: 0x02
        bit_length: 32
        data_type: "INT32"
        description: "Target Velocity"

# DC 동기화 주의사항:
# 1. 모든 slave가 DC를 지원해야 함 (slave 스펙 확인 필요)
# 2. sync0_cycle_time은 RT cycle time과 동일하게 설정 권장
# 3. reference_slave는 네트워크에서 가장 가까운 장치 선택
# 4. DC 활성화 시 jitter가 크게 감소하여 다중 축 제어 성능 향상
# 5. ±1μs 정밀도로 동기화되어 모터 간 위상 차이 최소화
